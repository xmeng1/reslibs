# 项目上下文

## 项目目标
ResLibs 通用资源平台是一个自动化的多类型资源分享平台，实现从源存储到变现文件托管服务的内容聚合和分发。该平台支持包括但不限于 Unity Assets、软件工具、设计素材、教育课程、多媒体文件等多种资源类型，为用户提供清洁的资源发现界面，为管理员提供简化的发布工作流程，通过高级文件托管佣金和网站广告产生收入。

## 技术栈
- **前端**: Next.js 14+ (App Router)、TypeScript、Tailwind CSS、Shadcn/UI、Three.js (3D模型查看)、FFmpeg.js (媒体处理)
- **后端**: Next.js Server Actions、PostgreSQL、Prisma ORM、Clerk/NextAuth、插件化架构
- **自动化**: Python 3.11+、Google Gemini API、多源下载器 (BaiduPCS、阿里云盘SDK等)
- **媒体处理**: FFmpeg、PIL/Pillow、Unity包解析器、3D模型优化器
- **部署**: Docker、Docker Compose、1Panel、Vercel、GPU支持容器
- **基础设施**: Linux VPS、Cloudflare R2、CDN加速

## 项目约定

### 代码风格
- 使用 TypeScript 严格模式和适当的类型定义
- 遵循 Prettier 配置以保持一致的格式
- 文件名使用 kebab-case，组件使用 PascalCase
- 实施 ESLint 规则以保证代码质量
- 使用约定式提交进行版本控制
- 支持多语言注释和文档

### 架构模式
- **微服务**: 分离的 Web 前端和自动化机器人服务，支持资源类型插件
- **API 优先**: 具有适当 HTTP 状态代码的 RESTful API，支持类型特定端点
- **数据库**: 具有动态模式的关系设计，支持多类型元数据
- **文件存储**: 多媒体对象存储，类型特定的预处理和优化
- **错误处理**: 全面的错误日志记录和类型特定的重试机制
- **插件系统**: 可插拔的资源类型处理器和展示模板

### 测试策略
- 业务逻辑单元测试（Jest），包括类型特定逻辑
- API 端点集成测试，覆盖所有资源类型
- 多类型资源端到端测试
- 文件处理和媒体转换性能测试
- 高流量和大规模内容负载测试
- 插件系统兼容性测试

### Git 工作流
- **主分支**: 生产就绪代码
- **功能分支**: `feature/resource-type-feature` 命名约定
- **类型分支**: `resource-type/new-type-name` 用于新资源类型开发
- **约定式提交**: `type(scope): description` 格式，支持类型标识
- **拉取请求**: 所有更改都需要同行评审和类型兼容性检查
- **自动化 CI**: 合并时的代码检查、多类型测试和部署

## 领域上下文
- **多类型资源**: Unity Assets、3D模型、软件工具、设计素材、视频课程、音频资源、文档资料等
- **动态类型管理**: 支持管理员添加和配置新的资源类型
- **智能内容生成**: 基于资源类型特点的AI内容增强
- **多媒体处理**: 图像优化、视频转码、3D模型处理、音频压缩
- **多样化分发**: 根据资源类型选择最佳的托管和分发策略
- **用户体验**: 类似 koudaizy.com 的清洁界面，支持多种资源展示方式

## 重要约束
- **类型扩展性**: 必须支持轻松添加新资源类型而无需修改核心代码
- **成本效率**: 尽可能使用 API 的免费层，根据资源类型优化资源使用
- **多媒体性能**: 高效处理各种格式的文件下载、处理和上传
- **可靠性**: 针对不同来源和资源类型的错误处理和恢复机制
- **安全性**: 适当的 API 密钥管理、文件验证和类型特定的安全检查
- **可扩展性**: 基于容器的部署，支持不同资源类型的专用处理环境
- **法律合规**: 尊重集成平台的服务条款，支持内容审核和版权管理

## 外部依赖
- **多源存储**: 百度网盘、阿里云盘、其他云盘平台，使用相应的SDK和工具
- **Google Gemini API**: AI 驱动的类型特定内容生成（gemini-1.5-flash/pro）
- **文件托管 API**: 多样化的托管服务（Rapidgator、诚通、飞猫云、程序下载站等）
- **Cloudflare R2**: 具有兼容 S3 API 的多媒体存储和CDN分发
- **媒体处理库**: FFmpeg、ImageMagick、Unity包解析器、3D模型处理工具
- **1Panel**: 服务器管理和反向代理配置，支持多服务部署
- **Vercel**: Web 应用程序托管和CI/CD，支持全球分发
