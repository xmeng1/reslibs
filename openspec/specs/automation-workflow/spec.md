# 自动化工作流

### 需求: 处理 Unity 资源任务
系统应提供一个自动化 CLI 任务 `process_unity_asset`，用于处理单个或批量 Unity 资源。

#### 场景: 任务触发
- **当** 管理员运行 Python CLI 时
- **那么** 自动化工作流开始处理 Unity 资源

### 需求: 资源获取阶段
系统应从百度网盘下载并预处理资源。

#### 场景: 输入验证
- **当** 管理员提供百度分享链接和提取码时
- **那么** 系统验证并处理输入

#### 场景: 文件下载
- **当** 提供有效凭据时
- **那么** 脚本使用 BaiduPCS 工具将文件下载到 `./temp/download/` 目录

#### 场景: 预处理
- **当** 检测到压缩文件时（.zip, .rar, .7z, .unitypackage）
- **那么** 系统提取文件列表、预览图像，并从文件名中识别关键词

### 需求: AI 内容生成
系统应使用 LLM API 生成 SEO 友好的内容。

#### 场景: 内容输入处理
- **当** 提取文件元数据时
- **那么** 系统将文件名、readme 内容和目录结构发送到 LLM API

#### 场景: SEO 内容输出
- **当** LLM 处理完成时
- **那么** 系统接收包含以下内容的 JSON：SEO 优化的标题（英文+中文）、300字详细描述（Markdown）、3-5个相关标签

### 需求: 多主机分发
系统应将处理后的资源分发到多个文件托管服务。

#### 场景: 重新打包
- **当** 资源需要品牌标识时
- **那么** 系统可选择在重新压缩前添加宣传文本 `READ_ME_RESLIBS.txt`

#### 场景: 多渠道上传
- **当** 分发开始时
- **那么** 系统上传到国内渠道（诚通/飞猫云）和国际渠道（Rapidgator/Turbobit）

#### 场景: 链接聚合
- **当** 上传成功完成时
- **那么** 系统收集公共下载 URL 并可选择生成短链接

### 需求: 网站发布
系统应自动将处理后的内容发布到 CMS。

#### 场景: 图像处理
- **当** 提取预览图像时
- **那么** 系统将它们上传到对象存储（R2/AWS S3）并获取 URL

#### 场景: 数据库条目
- **当** 所有元数据准备就绪时
- **那么** 系统创建新的 Post 条目，包含：AI 生成的标题、带预览图像的 AI 生成描述、变现下载链接、草稿或已发布状态

#### 场景: 清理
- **当** 发布完成时
- **那么** 系统删除临时本地文件

### 需求: 错误处理
系统应通过适当的重试机制优雅地处理故障。

#### 场景: 下载失败恢复
- **当** 百度网盘下载失败时（验证码/限速）
- **那么** 系统实现重试逻辑或发送警报

#### 场景: 损坏检测
- **当** 文件解压失败时
- **那么** 系统将资源标记为已损坏并通知管理员